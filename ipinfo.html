<script type="text/javascript">
    RED.nodes.registerType('ipinfo', {
        category: 'function',
        color: '#ffffff',
        defaults: {
            name: { value: "" },
            property: {
                value: "payload", required: true,
                label: RED._("node-red:common.label.property"),
                validate: RED.validators.typedInput({ type: 'msg', allowBlank: true })
            },
            propertyout: {
                value: "payload", required: true,
                label: RED._("node-red:common.label.property"),
                validate: RED.validators.typedInput({ type: 'msg', allowBlank: true })
            },
            config: {value:"", type:"ipinfo-config", required:true},
        },
        inputs: 1,
        outputs: 1,
        icon: "ipinfo.svg",
        label: function () {
            return this.name || "ipinfo";
        },
        labelStyle: function() {
            return this.name?"node_label_italic":"";
        },
        inputLabels: "ip",
        outputLabels: ["ipinfo"],
        oneditprepare: function () {
            if (this.property === undefined) {
                $("#node-input-property").val("payload");
            }
            $("#node-input-property").typedInput({ default: 'msg', types: ['msg'] });

            if (this.property === undefined) {
                $("#node-input-propertyout").val("payload");
            }
            $("#node-input-propertyout").typedInput({ default: 'msg', types: ['msg'] });
        }
    });
</script>

<script type="text/html" data-template-name="ipinfo">
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-sign-in"></i> <span data-i18n="ipinfo.label.property"></span></label>
        <input type="text" id="node-input-property" style="width:calc(70% - 1px)"/>
    </div>
    <div class="form-row">
        <label for="node-input-property"><i class="fa fa-sign-out"></i> <span data-i18n="ipinfo.label.propertyout"></span></label>
        <input type="text" id="node-input-propertyout" style="width:calc(70% - 1px)"/>
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> <span data-i18n="ipinfo.label.name"></span></label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-config"><i class="fa fa-cogs"></i> <span data-i18n="ipinfo.label.config"></span></label>
        <input type="text" id="node-input-config" placeholder="Token">
    </div>
</script>

<script type="text/html" data-help-name="ipinfo">
    <p>IPinfo NodeJS Client Library for Node Red</p>
    <p dir="auto">This node retrieves information about an IP address.</p>

    <h3>Node</h3>
    <ul dir="auto">
        <li><code>input</code> : <code>msg.payload</code> Where retrieve the IP adress from the message</li>
        <li><code>output</code> : <code>msg.payload</code> Where put the result into the node-red image</li>
        <li><code>name</code> : Name of the instance node</li>
        <li><code>config</code> : <code>IPInfo Config</code></li>
    </ul>
    
    <h3>Other info</h3>
    <a href="https://flows.nodered.org/node/@gautric/node-red-ipinfo" target="_blank">More info at Node-Red</a>
    <img alt="Version" src="https://img.shields.io/npm/v/@gautric/node-red-ipinfo.svg">

</script>